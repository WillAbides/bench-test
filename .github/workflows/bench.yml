name: bench

on:
  push:
  workflow_dispatch:

jobs:
  benchdiff:
    runs-on: ubuntu-20.04
    defaults:
      run:
        shell: bash
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - uses: actions/setup-go@v2
        with:
          go-version: "~1.15"
      - uses: WillAbides/benchdiff-action@prbase
        id: benchdiff
        with:
          benchdiff_version: 0.6.2
          status_name: bench-result
          benchdiff_args: --base-ref=$default_base_ref --count=5 --benchtime 10ms --benchstat-output markdown
      - name: output
        run: echo '${{ toJson(steps.benchdiff.outputs) }}'
